<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Audiobook | Love Bites: 101 Dating Disasters</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéß</text></svg>">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    
    <style>
        :root {
            --bg-dark: #0a0a0a;
            --bg-card: #1a1a1a;
            --accent-red: #dc2626;
            --accent-rose: #f43f5e;
            --accent-gold: #d4af37;
            --text-white: #ffffff;
            --text-muted: #9ca3af;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            margin: 0;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(220, 38, 38, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(244, 63, 94, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(212, 175, 55, 0.05) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        /* Floating particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--accent-gold);
            border-radius: 50%;
            opacity: 0;
            animation: floatParticle 15s infinite;
        }

        .particle:nth-child(1) { left: 10%; animation-delay: 0s; }
        .particle:nth-child(2) { left: 20%; animation-delay: 2s; }
        .particle:nth-child(3) { left: 30%; animation-delay: 4s; }
        .particle:nth-child(4) { left: 40%; animation-delay: 6s; }
        .particle:nth-child(5) { left: 50%; animation-delay: 8s; }
        .particle:nth-child(6) { left: 60%; animation-delay: 10s; }
        .particle:nth-child(7) { left: 70%; animation-delay: 12s; }
        .particle:nth-child(8) { left: 80%; animation-delay: 14s; }
        .particle:nth-child(9) { left: 90%; animation-delay: 1s; }
        .particle:nth-child(10) { left: 95%; animation-delay: 3s; }

        @keyframes floatParticle {
            0% { transform: translateY(100vh) scale(0); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.2; }
            100% { transform: translateY(-100px) scale(1); opacity: 0; }
        }

        /* Main Container */
        .order-container {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 520px;
            background: linear-gradient(145deg, rgba(26, 26, 26, 0.95), rgba(10, 10, 10, 0.98));
            border-radius: 24px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 
                0 25px 80px rgba(0, 0, 0, 0.5),
                0 0 60px rgba(220, 38, 38, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            overflow: hidden;
        }

        /* Close Button */
        .close-order-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .close-order-btn:hover {
            background: rgba(220, 38, 38, 0.3);
            border-color: rgba(220, 38, 38, 0.5);
            transform: scale(1.1);
        }

        /* Header */
        .order-header {
            background: linear-gradient(135deg, var(--bg-dark), #111);
            padding: 30px 30px 25px;
            text-align: center;
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
            position: relative;
        }

        .order-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-gold), transparent);
            pointer-events: none;
        }

        /* Brand Badge */
        .brand-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            padding: 6px 16px;
            border-radius: 50px;
            margin-bottom: 20px;
        }

        .brand-badge .brand-icon {
            font-size: 20px;
        }

        .brand-badge .brand-name {
            font-size: 11px;
            font-weight: 700;
            color: var(--accent-gold);
            letter-spacing: 2px;
        }

        /* Product Info */
        .product-info {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .product-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.2), rgba(244, 63, 94, 0.1));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            border: 1px solid rgba(220, 38, 38, 0.3);
        }

        .product-details h1 {
            font-size: 20px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }

        .product-details p {
            font-size: 13px;
            color: var(--text-muted);
        }

        /* Price Display */
        .price-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .header-price {
            font-size: 36px;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-gold), #f4d03f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .price-badge {
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Form Body */
        .order-body {
            padding: 30px;
        }

        /* Form Groups */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 8px;
        }

        .form-group label .required {
            color: var(--accent-red);
        }

        .form-group input {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            color: white;
            font-size: 15px;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent-gold);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.15);
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .form-group input.input-error {
            border-color: var(--accent-red);
            background: rgba(220, 38, 38, 0.1);
        }

        .error-text {
            color: var(--accent-red);
            font-size: 12px;
            margin-top: 5px;
            display: block;
        }

        /* Coupon Section */
        .coupon-section {
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .coupon-section label {
            font-size: 13px;
            color: var(--accent-gold);
            margin-bottom: 10px;
            display: block;
        }

        .coupon-row {
            display: flex;
            gap: 10px;
        }

        .coupon-row input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            text-transform: uppercase;
        }

        .coupon-row input:focus {
            outline: none;
            border-color: var(--accent-gold);
        }

        .coupon-row button {
            padding: 12px 20px;
            background: var(--accent-gold);
            border: none;
            border-radius: 8px;
            color: black;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .coupon-row button:hover {
            background: #e5c340;
            transform: scale(1.02);
        }

        .coupon-msg {
            font-size: 12px;
            margin-top: 8px;
        }

        .coupon-msg.success {
            color: #22c55e;
        }

        .coupon-msg.error {
            color: var(--accent-red);
        }

        /* Price Summary */
        .price-summary {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }

        .price-row.discount {
            color: #22c55e;
            display: none;
        }

        .price-row.discount.show {
            display: flex;
        }

        .price-row.total {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 15px;
            margin-top: 10px;
            font-size: 18px;
            font-weight: 700;
        }

        .price-row.total .amount {
            color: var(--accent-gold);
            font-size: 24px;
        }

        /* Payment Methods */
        .payment-methods {
            margin-bottom: 25px;
        }

        .payment-methods h3 {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .payment-option {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }

        .payment-option:hover {
            border-color: rgba(212, 175, 55, 0.5);
            background: rgba(255, 255, 255, 0.08);
        }

        .payment-option.selected {
            border-color: var(--accent-gold);
            background: rgba(212, 175, 55, 0.1);
        }

        .payment-option input[type="radio"] {
            display: none;
        }

        .payment-option-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .payment-icon {
            width: 50px;
            height: 35px;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #003087;
            font-size: 12px;
        }

        .payment-details h4 {
            font-size: 15px;
            color: white;
            margin-bottom: 3px;
        }

        .payment-details p {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* PayPal Button Container */
        #paypal-button-container {
            margin-top: 20px;
            display: none;
        }

        #paypal-button-container.show {
            display: block;
        }

        /* Submit Button */
        .submit-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--accent-red), var(--accent-rose));
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(220, 38, 38, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Security Badges */
        .security-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.2);
            border-radius: 8px;
            font-size: 12px;
            color: #22c55e;
        }

        .trust-logos {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
        }

        .trust-logo {
            opacity: 0.6;
            font-size: 24px;
            color: white;
        }

        /* Success Screen */
        .success-screen {
            display: none;
            text-align: center;
            padding: 50px 30px;
        }

        .success-screen.show {
            display: block;
        }

        .success-icon {
            font-size: 100px;
            margin-bottom: 25px;
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .success-screen h2 {
            font-size: 28px;
            color: white;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #22c55e, #4ade80);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .success-screen .success-subtitle {
            color: var(--text-muted);
            margin-bottom: 25px;
            font-size: 16px;
        }

        .order-id-display {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.05));
            border: 2px solid rgba(34, 197, 94, 0.4);
            padding: 20px 25px;
            border-radius: 12px;
            font-size: 18px;
            color: #22c55e;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .success-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: left;
        }

        .success-info-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .success-info-item:last-child {
            border-bottom: none;
        }

        .success-info-item .icon {
            font-size: 20px;
        }

        .success-info-item .text {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .success-info-item .text strong {
            color: var(--accent-gold);
        }

        .success-btn {
            padding: 16px 50px;
            background: linear-gradient(135deg, var(--accent-gold), #e5c340);
            border: none;
            border-radius: 12px;
            color: black;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .success-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
        }

        /* Loading Overlay */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--accent-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            margin-top: 20px;
            font-size: 16px;
        }

        /* Back Link */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 13px;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .order-container {
                border-radius: 16px;
            }
            .order-header, .order-body {
                padding: 20px;
            }
            .product-info {
                flex-direction: column;
                text-align: center;
            }
            .header-price {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <!-- Particles -->
    <div class="particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Processing your order...</div>
    </div>

    <!-- Main Container -->
    <div class="order-container">
        <button class="close-order-btn" onclick="goBack()" title="Back to site">‚úï</button>

        <!-- Header -->
        <div class="order-header">
            <div class="brand-badge">
                <span class="brand-icon">üé¨</span>
                <span class="brand-name">NO-ART GALLERY</span>
            </div>

            <div class="product-info">
                <div class="product-icon">üéß</div>
                <div class="product-details">
                    <h1>Love Bites: 101 Dating Disasters</h1>
                    <p>Full Audiobook ‚Ä¢ 4+ Hours ‚Ä¢ MP3 Download</p>
                </div>
            </div>

            <div class="price-display">
                <span class="header-price" id="headerPrice">$19.90</span>
                <span class="price-badge">üî• Launch Price!</span>
            </div>
        </div>

        <!-- Order Form -->
        <div class="order-body">
            <form id="orderForm" onsubmit="return validateAndPay()">
                
                <!-- Name -->
                <div class="form-group">
                    <label>Full Name <span class="required">*</span></label>
                    <input type="text" id="customerName" placeholder="Enter your full name" required>
                    <span class="error-text" id="nameError"></span>
                </div>

                <!-- Email -->
                <div class="form-group">
                    <label>Email Address <span class="required">*</span></label>
                    <input type="email" id="customerEmail" placeholder="your@email.com" required>
                    <span class="error-text" id="emailError"></span>
                    <small style="color: var(--text-muted); font-size: 11px; margin-top: 5px; display: block;">
                        üìß Your personalized audiobook will be sent to this email
                    </small>
                </div>

                <!-- Coupon -->
                <div class="coupon-section">
                    <label>üéüÔ∏è Have a coupon code?</label>
                    <div class="coupon-row">
                        <input type="text" id="couponCode" placeholder="Enter code">
                        <button type="button" onclick="applyCoupon()">Apply</button>
                    </div>
                    <div class="coupon-msg" id="couponMsg"></div>
                </div>

                <!-- Price Summary -->
                <div class="price-summary">
                    <div class="price-row">
                        <span>Audiobook</span>
                        <span>$19.90</span>
                    </div>
                    <div class="price-row discount" id="discountRow">
                        <span>Discount</span>
                        <span id="discountAmount">-$0.00</span>
                    </div>
                    <div class="price-row total">
                        <span>Total</span>
                        <span class="amount" id="totalPrice">$19.90</span>
                    </div>
                </div>

                <!-- Payment Methods -->
                <div class="payment-methods">
                    <h3>üí≥ Payment Method</h3>
                    
                    <label class="payment-option selected" onclick="selectPayment('paypal')">
                        <input type="radio" name="payment" value="paypal" checked>
                        <div class="payment-option-content">
                            <div class="payment-icon">PayPal</div>
                            <div class="payment-details">
                                <h4>PayPal</h4>
                                <p>Pay securely with PayPal or Credit Card</p>
                            </div>
                        </div>
                    </label>
                </div>

                <!-- PayPal Button -->
                <div id="paypal-button-container" class="show"></div>

                <!-- Or Manual Payment -->
                <div style="text-align: center; margin: 20px 0; color: var(--text-muted); font-size: 13px;">
                    <p>‚Äî or pay manually ‚Äî</p>
                </div>

                <!-- Manual PayPal Instructions -->
                <div class="manual-payment" style="background: rgba(0, 102, 204, 0.1); border: 1px solid rgba(0, 102, 204, 0.3); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <h4 style="color: #0066cc; margin-bottom: 10px; font-size: 14px;">üì± Manual PayPal Payment</h4>
                    <ol style="color: var(--text-muted); font-size: 13px; padding-left: 20px; line-height: 1.8;">
                        <li>Send <strong style="color: white;">$<span id="manualPayAmount">19.90</span></strong> to: <strong style="color: #0066cc;">nir@funnydates101.com</strong></li>
                        <li>Include your name in the payment note</li>
                        <li>Fill the form above and click "Complete Order"</li>
                    </ol>
                    
                    <div class="form-group" style="margin-top: 15px; margin-bottom: 0;">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="manualPayConfirm" style="width: 20px; height: 20px;">
                            <span style="font-size: 13px;">I have sent the payment via PayPal</span>
                        </label>
                    </div>
                    
                    <div class="form-group" id="paypalEmailGroup" style="margin-top: 15px; display: none;">
                        <label>PayPal Email Used <span class="required">*</span></label>
                        <input type="email" id="paypalEmail" placeholder="Email you paid from">
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="submit-btn" id="submitBtn">
                    <span>Complete Order</span>
                    <span>‚Üí</span>
                </button>

                <!-- Security -->
                <div class="security-badges">
                    <div class="security-badge">
                        <span>üîí</span>
                        <span>Secure Payment</span>
                    </div>
                    <div class="security-badge">
                        <span>‚ö°</span>
                        <span>Instant Delivery</span>
                    </div>
                    <div class="security-badge">
                        <span>‚úì</span>
                        <span>100% Satisfaction</span>
                    </div>
                </div>
                
                <div class="trust-logos">
                    <span style="font-weight: 700; color: #0070ba;">PayPal</span>
                    <span style="color: #666;">|</span>
                    <span style="font-weight: 600; color: #ff5f00;">Mastercard</span>
                    <span style="color: #666;">|</span>
                    <span style="font-weight: 600; color: #1a1f71;">Visa</span>
                </div>

            </form>

            <!-- Success Screen -->
            <div class="success-screen" id="successScreen">
                <div class="success-icon">üéâ</div>
                <h2>Thank You for Your Order!</h2>
                <p class="success-subtitle">Your order has been received and is being processed</p>
                
                <div class="order-id-display" id="orderIdDisplay">üé´ Order #: ---</div>
                
                <div class="success-info">
                    <div class="success-info-item">
                        <span class="icon">üìß</span>
                        <span class="text">Your personalized audiobook will be sent to your email within <strong>24 hours</strong></span>
                    </div>
                    <div class="success-info-item">
                        <span class="icon">üéß</span>
                        <span class="text">MP3 format, works on all devices</span>
                    </div>
                    <div class="success-info-item">
                        <span class="icon">üí¨</span>
                        <span class="text">Questions? Contact us at: <strong>nir@funnydates101.com</strong></span>
                    </div>
                </div>
                
                <button class="success-btn" onclick="closeSuccess()">Back to Site ‚Üí</button>
            </div>

            <a href="https://funnydates101.com" class="back-link">
                ‚Üê Back to FunnyDates101.com
            </a>
        </div>
    </div>

    <script>
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Firebase Configuration
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const firebaseConfig = {
            apiKey: "AIzaSyA6laY3N84Pe_Fl1769bIoP4NbCxjmqP_o",
            authDomain: "i4iguana-89ed1.firebaseapp.com",
            projectId: "i4iguana-89ed1",
            storageBucket: "i4iguana-89ed1.firebasestorage.app",
            messagingSenderId: "143460198551",
            appId: "1:143460198551:web:5db80d325a549f3e4661d2"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Pricing & Coupons
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const BASE_PRICE = 19.90;
        const COUPONS = {
            'LAUNCH20': 20,
            'TIKTOK10': 10,
            'YOUTUBE10': 10,
            'PODCAST15': 15,
            'VIP20': 20,
            'FRIENDS10': 10,
            '10110': 10
        };

        let currentDiscount = 0;
        let appliedCode = '';

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Show/Hide PayPal email field
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        document.getElementById('manualPayConfirm').addEventListener('change', function() {
            const emailGroup = document.getElementById('paypalEmailGroup');
            if (this.checked) {
                emailGroup.style.display = 'block';
            } else {
                emailGroup.style.display = 'none';
            }
        });

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Apply Coupon
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function applyCoupon() {
            const code = document.getElementById('couponCode').value.trim().toUpperCase();
            const couponMsg = document.getElementById('couponMsg');
            const discountRow = document.getElementById('discountRow');

            if (!code) {
                couponMsg.textContent = 'Please enter a coupon code';
                couponMsg.className = 'coupon-msg error';
                return;
            }

            if (COUPONS[code]) {
                currentDiscount = COUPONS[code];
                appliedCode = code;
                const discountAmount = (BASE_PRICE * currentDiscount / 100).toFixed(2);
                const finalPrice = (BASE_PRICE - parseFloat(discountAmount)).toFixed(2);

                couponMsg.textContent = '‚úì Coupon applied! ' + currentDiscount + '% off';
                couponMsg.className = 'coupon-msg success';
                discountRow.classList.add('show');
                document.getElementById('discountAmount').textContent = '-$' + discountAmount;
                document.getElementById('totalPrice').textContent = '$' + finalPrice;
                document.getElementById('headerPrice').textContent = '$' + finalPrice;
                document.getElementById('manualPayAmount').textContent = finalPrice;
            } else {
                currentDiscount = 0;
                appliedCode = '';
                couponMsg.textContent = '‚úó Invalid coupon code';
                couponMsg.className = 'coupon-msg error';
                discountRow.classList.remove('show');
                document.getElementById('totalPrice').textContent = '$' + BASE_PRICE.toFixed(2);
                document.getElementById('headerPrice').textContent = '$' + BASE_PRICE.toFixed(2);
                document.getElementById('manualPayAmount').textContent = BASE_PRICE.toFixed(2);
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Validation Helpers
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function showError(elementId, message) {
            document.getElementById(elementId).textContent = message;
        }

        function clearErrors() {
            document.getElementById('nameError').textContent = '';
            document.getElementById('emailError').textContent = '';
            document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));
        }

        function generateOrderId() {
            const timestamp = Date.now().toString(36).toUpperCase();
            const random = Math.random().toString(36).substring(2, 6).toUpperCase();
            return 'EN-' + timestamp + '-' + random;
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Validate and Process Order
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function validateAndPay() {
            clearErrors();

            const name = document.getElementById('customerName').value.trim();
            const email = document.getElementById('customerEmail').value.trim();
            const manualPay = document.getElementById('manualPayConfirm').checked;
            const paypalEmail = document.getElementById('paypalEmail').value.trim();

            let isValid = true;
            let firstErrorInput = null;

            // Name validation
            if (!name || name.length < 2) {
                showError('nameError', '‚ö†Ô∏è Please enter your full name');
                document.getElementById('customerName').classList.add('input-error');
                if (!firstErrorInput) firstErrorInput = document.getElementById('customerName');
                isValid = false;
            }

            // Email validation
            if (!email) {
                showError('emailError', '‚ö†Ô∏è Required field');
                document.getElementById('customerEmail').classList.add('input-error');
                if (!firstErrorInput) firstErrorInput = document.getElementById('customerEmail');
                isValid = false;
            } else if (!isValidEmail(email)) {
                showError('emailError', '‚ö†Ô∏è Please enter a valid email address');
                document.getElementById('customerEmail').classList.add('input-error');
                if (!firstErrorInput) firstErrorInput = document.getElementById('customerEmail');
                isValid = false;
            }

            // Manual payment confirmation
            if (!manualPay) {
                alert('‚ö†Ô∏è Please confirm that you have sent the PayPal payment, or use the PayPal button above.');
                isValid = false;
            }

            // PayPal email if manual
            if (manualPay && !paypalEmail) {
                alert('‚ö†Ô∏è Please enter the PayPal email you paid from');
                isValid = false;
            } else if (manualPay && !isValidEmail(paypalEmail)) {
                alert('‚ö†Ô∏è Please enter a valid PayPal email');
                isValid = false;
            }

            // Scroll to first error
            if (!isValid && firstErrorInput) {
                firstErrorInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
                firstErrorInput.focus();
                return false;
            }

            if (!isValid) {
                return false;
            }

            // Process order
            processOrder(name, email, paypalEmail);
            return false;
        }

        function processOrder(name, email, paypalEmail) {
            const finalPrice = currentDiscount > 0 
                ? (BASE_PRICE * (1 - currentDiscount/100)).toFixed(2)
                : BASE_PRICE.toFixed(2);

            const orderId = generateOrderId();

            const orderData = {
                orderId: orderId,
                customerName: name,
                customerEmail: email,
                paypalEmail: paypalEmail,
                basePrice: BASE_PRICE,
                discountCode: appliedCode || null,
                discountPercent: currentDiscount || 0,
                finalPrice: parseFloat(finalPrice),
                product: 'audiobook-en',
                productName: 'Love Bites: 101 Dating Disasters (Audiobook)',
                paymentMethod: 'paypal-manual',
                status: 'pending',
                createdAt: firebase.firestore.Timestamp.fromDate(new Date()),
                source: 'funnydates101.com'
            };

            // Show loading
            document.getElementById('loadingOverlay').classList.add('show');

            // Timeout
            const timeoutId = setTimeout(() => {
                document.getElementById('loadingOverlay').classList.remove('show');
                alert('‚ö†Ô∏è Error submitting order!\n\nPlease contact us at:\nnir@funnydates101.com\n\nOrder ID: ' + orderId);
            }, 10000);

            // Save to Firebase
            db.collection('audiobook_orders').doc(orderId).set(orderData)
                .then(() => {
                    clearTimeout(timeoutId);
                    document.getElementById('loadingOverlay').classList.remove('show');
                    document.getElementById('orderIdDisplay').textContent = 'üé´ Order #: ' + orderId;
                    document.getElementById('orderForm').style.display = 'none';
                    document.getElementById('successScreen').classList.add('show');
                })
                .catch((error) => {
                    clearTimeout(timeoutId);
                    document.getElementById('loadingOverlay').classList.remove('show');
                    alert('Error saving order: ' + error.message + '\n\nPlease contact: nir@funnydates101.com');
                });
        }

        function closeSuccess() {
            window.location.href = 'https://funnydates101.com';
        }

        function goBack() {
            window.location.href = 'https://funnydates101.com';
        }

        function selectPayment(method) {
            document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // PayPal Smart Buttons (Optional - for direct payment)
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        /*
        paypal.Buttons({
            createOrder: function(data, actions) {
                const finalPrice = currentDiscount > 0 
                    ? (BASE_PRICE * (1 - currentDiscount/100)).toFixed(2)
                    : BASE_PRICE.toFixed(2);
                    
                return actions.order.create({
                    purchase_units: [{
                        description: 'Love Bites: 101 Dating Disasters - Audiobook',
                        amount: {
                            value: finalPrice
                        }
                    }]
                });
            },
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(details) {
                    const name = document.getElementById('customerName').value.trim();
                    const email = document.getElementById('customerEmail').value.trim();
                    processOrder(name, email, details.payer.email_address);
                });
            }
        }).render('#paypal-button-container');
        */

        console.log('üìú Order page loaded!');
    </script>
</body>
</html>
